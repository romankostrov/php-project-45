#!/usr/bin/env php
<?php
require __DIR__ . '/../vendor/autoload.php'; // Подключаем автозагрузчик Composer

use BrainGames\Cli\Cli;

function isEven($number)
{
    return $number % 2 === 0;
}

function getRandomExpression()
{
    return rand(1, 100);
}

function playGame($userName)
{
    echo "Answer \"yes\" if the number is even, otherwise answer \"no\".\n";

    $correctAnswersCount = 0;

    while ($correctAnswersCount < 3) {
        $number = getRandomExpression();
        echo "Question: $number\n";

        $userAnswer = trim(fgets(STDIN));

        $correctAnswer = isEven($number) ? 'yes' : 'no';

        if ($userAnswer !== $correctAnswer) {
            echo "'$userAnswer' is wrong answer ;(. Correct answer was '$correctAnswer'.\n";
            echo "Let's try again, $userName!\n";
            return;
        }

        echo "Correct!\n";
        $correctAnswersCount++;
    }

    echo "Congratulations, $userName!\n";
}

// Главная функция, которая запускает игру
function startGame()
{
    $cli = new Cli();
    $userName = $cli->greetUser();
    playGame($userName);
}

// Запускаем игру
startGame();