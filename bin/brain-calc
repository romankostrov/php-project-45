#!/usr/bin/env php
<?php
require __DIR__ . '/../vendor/autoload.php'; // Подключаем автозагрузчик Composer

use BrainGames\Cli\Cli;

function getRandomExpression()
{
    $operations = ['+', '-', '*'];
    $num1 = rand(1, 50);
    $num2 = rand(1, 50);
    $operation = $operations[array_rand($operations)];

    return [
        'expression' => "$num1 $operation $num2",
        'result' => eval("return $num1 $operation $num2;")
    ];
}

function playGame($userName)
{
    for ($i = 0; $i < 3; $i++) {
        $data = getRandomExpression();
        $question = $data['expression'];
        $correctAnswer = $data['result'];

        echo "What is the result of the expression?\n";
        echo "Question: $question\n";
        echo "Your answer: ";
        $userAnswer = trim(fgets(STDIN));

        if ($userAnswer != $correctAnswer) {
            echo "'$userAnswer' is wrong answer ;(. Correct answer was '$correctAnswer'.\n";
            echo "Let's try again, $userName!\n";
            return;
        }

        echo "Correct!\n";
    }

    echo "Congratulations, $userName!\\n";
}

// Главная функция, которая запускает игру
function startGame()
{
    $cli = new Cli();
    $userName = $cli->greetUser();
    playGame($userName);
}

// Запускаем игру
startGame();